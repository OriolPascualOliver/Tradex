server {
  listen 80;
  server_name _;

  # ---- Pages root ----
  root /usr/share/nginx/html;
  index index.html;

  # Enable Server Side Includes for partials under /partials/*
  ssi on;
  ssi_types text/html;

  # Pretty URLs: fall back to index.html if needed
  location / {
    try_files $uri $uri/ /index.html;
  }

  # ---- Assets (from frontend/public) ----
  # If your HTML uses /public/css/style.css (recommended), no extra config is needed.
  # If some pages still use /css/*, /js/*, or /images/*, these aliases keep them working:
  location /css/    { alias /usr/share/nginx/html/public/css/; }
  location /js/     { alias /usr/share/nginx/html/public/js/; }
  location /images/ { alias /usr/share/nginx/html/public/images/; }
  # Direct /public/* paths also work (no alias needed).

  # ---- API (your backend exposes /api-v1/*) ----
  location /api-v1/ {
    proxy_pass         http://api:8000/api-v1/;  # note trailing slash
    proxy_http_version 1.1;
    proxy_set_header   Host $host;
    proxy_set_header   X-Real-IP $remote_addr;
    proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header   X-Forwarded-Proto $scheme;
  }
}
